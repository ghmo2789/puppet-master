<html>
  <head>
      {% load static %}
      <link rel="stylesheet" href="{% static 'bootstrap/css/bootstrap.min.css' %}">
      <link rel="stylesheet" href="{% static 'bootstrap/css/bootstrap.css' %}">
      <link rel="stylesheet" href="{% static 'w3/w3.css' %}">
      <link rel="stylesheet" href="{% static 'website/website.css' %}">
  </head>
  <body class="bg-dark text-white">
    <!-- Navbar -->
    {% block nav %}{% include 'website/navbar.html' %}{% endblock nav %}
    <h1>Task History</h1>
    <form action="/website/kill_tasks" method="post" ></form>
      {% csrf_token %}
      <div class="w3-container table-wrapper-scroll-y w3-padding-16" style="height:500px; overflow: auto"> 
          <table class="table table-dark table-striped table-hover mb-0">
              <tr style="background-color: black;"> 
                <td><input type="checkbox" name="select_all" value="1" id="master_checkbox" onclick="select_all()"></td>
                <td>Task ID</td>
                <td>Client ID</td>
                <td>Start Time</td>
                <td>Finish Time</td>
                <td>Status</td>
                <td>Task Type</td>
                <td>Task Info</td>
              </tr>
            {% for i in data%}
              <tr>
                  <td><input type="checkbox" name="select" value="{{i.taskId}}" id="{{i.taskId}}"></td> 
                  <td>{{i.taskId}}</td>
                  <td>{{i.clientId}}</td>
                  <td>{{i.start}}</td>
                  <td>{{i.finish}}</td>
                  <td>{{i.status}}</td>
                  <td>{{i.taskType}}</td>
                  <td>{{i.taskInfo}}</td>
              </tr>
              {% endfor %}
          </table>
        </div>
        <input type="submit" id="website-kill-btn" class="btn btn-dark btn-lg btn-primary" value='Kill Task'>
        <p>Form status: {{formStatus}}</p>
      </form>

      <script type="text/javascript">

        // Initialize data for javascript
        let data = [];
        {% for i in data %}
          data.push({{i.taskId}});
        {% endfor %}
    
        function select_all(){
          if(document.getElementById("master_checkbox").checked) {
            for(let i = 0; i < data.length; i++) {
              document.getElementById(data[i]).checked = true; 
            }
          } else {
            for(let i = 0; i < data.length; i++) {
              document.getElementById(data[i]).checked = false; 
            }
          }
        }
      </script>
  </body> 
</html>